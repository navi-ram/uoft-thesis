{{< include preamble.qmd >}}
# Results

## ADHD Group

### Baseline Factors Related to Change in Response Inhibition

A multiple linear regression model for change in response inhibition after 5 weeks of intervention with all the predictors (age, gender, baseline response inhibition, working memory, EF impairment, ADHD symptoms, autism traits, stimulant medication use, and time on task) entered revealed a significant model fit indicating that the baseline characteristics entered predicted response to treatment, accounting for 45% of the variance (F = `{r} s5_F`, `{r} pvals["s5_p"]`, R^2^ = `{r} s5_r2`). Baseline response inhibition ($\beta$ = -0.30, p = 0.02) and baseline working memory ($\beta$ = -0.40, p = 0.0014) predicted improvement in response inhibition after 5 weeks regardless of treatment group such that lower (i.e., worse) baseline response inhibition and higher (i.e., better) baseline working memory (on the N-Back 1-back condition) predicted greater improvement after 5 weeks. Additionally, the model showed a significant interaction effect of baseline response inhibition by randomization group moderating change in response inhibition at 5 weeks post-treatment ($\beta$ = `{r} s5_beta_s`, `{r} pvals["s5_p_s"]`), ruling out the potential for regression to the mean explaining the result.

This result showed that lower (i.e., worse) baseline response inhibition was associated with a larger improvement in the Mega Team treatment group than in the TAU control group in response inhibition after 5 weeks of treatment. No other factors were significant predictors or moderators of change in response inhibition after 5 weeks of treatment (see @tbl-beta1).

A multiple linear regression model for change in response inhibition at 6 month follow-up with all predictors entered showed a significant model fit indicating that the baseline characteristics entered predicted response to treatment, accounting for 55% of the variance (F = `{r} s6_F`, `{r} pvals["s6_p"]`, R^2^ = `{r} s6_r2`). Gender predicted improvement in response inhibition regardless of treatment group such that girls improved more after 6 months compared to boys ($\beta$ = 0.20, p = 0.01). Baseline response inhibition ($\beta$ = -0.60, p \< 0.001) and baseline working memory (N-back 1-back condition only) ($\beta$ = -0.40, p = 0.0011) predicted improvement in response inhibition at 6 month follow-up regardless of treatment group, such that lower (i.e., worse) baseline response inhibition and higher (i.e., better) baseline working memory (1-back) predicted greater improvement at 6 month follow-up. Additionally, there was a significant interaction effect of baseline working memory (1-back) by randomization group moderating change in response inhibition ($\beta$ = `{r} s6_beta_ob`, `{r} pvals["s6_p_ob"]`), such that in the TAU control group greater (i.e., better) baseline working memory was associated with more improvement in response inhibition compared to those in the Mega Team treatment group. No other baseline factors were significant predictors or moderators of change in response inhibition at 6 month follow-up.

### Baseline Factors in Change in Working Memory

A multiple linear regression model for change in working memory (1-back condition of the N-back) after treatment with all baseline predictors entered revealed a significant model fit indicating baseline characteristics entered predicted change in working memory accounting for 32% of the variance (F = `{r} ob5_F`, `{r} pvals["ob5_p"]`, R^2^ = `{r} ob5_r2`). Lower (i.e., weaker) baseline working memory (1-back) predicted greater improvement in working memory (1-back) after 5 weeks regardless of treatment group ($\beta$ = -0.60, p \< 0.001). Additionally, time on task was a significant predictor of change in working memory after 5 weeks of treatment ($\beta$ = `{r} ob5_beta_tp`, `{r} pvals["ob5_p_tp"]`), such that greater time on task during treatment was associated with greater improvement in working memory after 5 weeks of treatment. No other individual baseline factors were significant predictors or moderators of change in working memory after 5 weeks of treatment.

The overall multiple linear regression model for change in 1-back working memory at 6 month follow-up with all baseline predictors entered significantly predicted change in working memory accounting for 25% of the variance (F = `{r} ob6_F`, `{r} pvals["ob6_p"]`, R^2^ = `{r} ob6_r2`); however this finding did not maintain significance after Bonferroni correction (p \< 0.0035).

The overall multiple linear regression model for change in 2-back working memory after 5 weeks of treatment with all baseline predictors entered revealed a significant model fit which predicted 35% of the variance (F = `{r} tb5_F`,`{r} pvals["tb5_p"]`, R^2^ = `{r} tb5_r2`). Lower (i.e., weaker) baseline 2-back working memory predicted more improvement on 2-back regardless of treatment group at 5 weeks post-treatment ($\beta$ = -0.40, p = 0.003). No other variables predicted improvement, and none were significant moderators of change in working memory (2-back task) at post-treatment.

At 6 month follow-up the multiple linear regression model for change in 2-back working memory revealed a significant model fit such that it predicted 38% of the variance (F = `{r} tb6_F`, `{r} pvals["tb6_p"]`, R^2^ = `{r} tb6_r2`). Similar to post-treatment, lower (i.e., weaker) baseline 2-back working memory predicted more improvement at 6 month follow-up regardless of treatment group ($\beta$ = -0.60, p \< 0.001). Additionally, there was a significant interaction effect of baseline 1-back working memory by randomization group which moderated change in 2-back working memory at 6 month follow-up ($\beta$ = `{r} tb6_beta_ob`, `{r} pvals["tb6_p_ob"]`), such that higher (i.e., better) baseline 1-back accuracy was associated with more improvement in the treatment group but not in the TAU group. No other factors were significant predictors or moderators of 2-back working memory change at 6 month follow-up.

### Baseline Factors in Change in ADHD Symptoms

A multiple linear regression model predicting change in ADHD symptoms after 5 weeks of training was significant overall and predicted 30% of the variance (F = `{r} ad5_F`, `{r} pvals["ad5_p"]`, R^2^ = `{r} ad5_r2`) and after 6 month follow-up predicting 35% of the variance (F = `{r} ad6_F`, `{r} pvals["ad6_p"]`, R^2^ = `{r} ad6_r2`). At both time points, lower baseline ADHD symptoms predicted greater improvement regardless of treatment group: $\beta$ = -0.70, p \< 0.001, 6 months: $\beta$ = -0.50, p \< 0.001). Additionally, at both time points lower baseline EF impairment predicted greater improvement in ADHD symptoms regardless of treatment group ($\beta$ = -0.50, p \< 0.001, 6 months: $\beta$ = -0.40, p = 0.005). No variables moderated the relationship by treatment. See @tbl-beta2 for results.

### Non-Significant Results

A multiple linear regression with all predictors entered did not significantly predict change in planning at 5 weeks post-treatment (F = `{r} t5_F`, `{r} pvals["t5_p"]`, R^2^ = `{r} t5_r2`) or at 6 month follow-up (F = `{r} t6_F`, `{r} pvals["t6_p"]`, R^2^ = `{r} t6_r2`) or predict academic fluency at 5 weeks post-treatment (F = `{r} w5_F`, `{r} pvals["w5_p"]`, R^2^ = `{r} w5_r2`) or at 6 month follow-up. See @tbl-beta3 for results.

A multiple linear regression with all predictors entered did not significantly predict change in EF impairment after 5 weeks of training (F = `{r} b5_F`, `{r} pvals["b5_p"]`, R^2^ = `{r} b5_r2`) or at 6 month follow-up (F = `{r} b6_F`, `{r} pvals["b6_p"]`, R^2^ = `{r} b6_r2`). See @tbl-beta2 for results.

```{r, eval=TRUE, results='asis'}
options(knitr.table.format = "latex")
#preps mergable tables
s5_tbl <- tbl_regression(s5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 

s6_tbl <- tbl_regression(s6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")


ob5_tbl <- tbl_regression(ob5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")


ob6_tbl <- tbl_regression(ob6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

tb5_tbl <- tbl_regression(tb5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

tb6_tbl <- tbl_regression(tb6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")


ad5_tbl <- tbl_regression(ad5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

ad6_tbl <- tbl_regression(ad6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

b5_tbl <- tbl_regression(b5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

b6_tbl <- tbl_regression(b6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

t5_tbl <- tbl_regression(t5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

t6_tbl <- tbl_regression(t6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

w5_tbl <- tbl_regression(w5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

w6_tbl <- tbl_regression(w6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")



#now prepping for ASD

s5_tbl2 <- tbl_regression(s5_mod_asd,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 

s6_tbl2 <- tbl_regression(s6_mod_asd,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 



ob5_tbl2 <- tbl_regression(ob5_mod_asd,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 

ob6_tbl2 <- tbl_regression(ob6_mod_asd,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 


b5_tbl2 <- tbl_regression(b5_mod_asd,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 


b6_tbl2 <- tbl_regression(b6_mod_asd,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 



```

::: landscape
```{r, eval=TRUE, results='asis'}
#| label: tbl-beta1
#| tbl-cap: Multiple Linear Regression Model Results Predicting Response Inhibition and Working Memory in ADHD group
options(knitr.table.format = "latex")
#https://stackoverflow.com/questions/45409750/get-rid-of-addlinespace-in-kable

tbl_merge(
  tbls = list(s5_tbl, s6_tbl, ob5_tbl, ob6_tbl, tb5_tbl, tb6_tbl),
  tab_spanner = c(glue("**Δ SSRT 5 Week** 
                       F = {s5_F}* 
                       R² = {s5_r2}"), 
                  glue("**Δ SSRT 6 Month** 
                       F = {s6_F}* 
                       R² = {s6_r2}"), 
                  glue("**Δ 1-back 5 Week** 
                       F = {ob5_F}* 
                       R² = {ob5_r2}"), 
                  glue("**Δ 1-back 6 Month** 
                       F = {ob6_F} 
                       R² = {ob6_r2}"), 
                  glue("**Δ 2-back 5 Week** 
                       F = {tb5_F}* 
                       R² = {tb5_r2}"), 
                  glue("**Δ 2-back 6 Month** 
                       F = {tb6_F}* 
                       R² = {tb6_r2}"))
  ) %>% 
  as_kable_extra(format = "latex", 
                 booktabs = TRUE, 
                 escape = FALSE, 
                 linesep = "", 
                 col.names = c("", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}"),
                 align = c("l", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c")) %>%
  footnote(general = "SSRT - Stop Signal Reaction Time. *\\\\textit{p}-value < 0.0035 (Bonferroni corrected); Bold p-value < 0.05.", 
           footnote_as_chunk = TRUE, 
           escape = FALSE,
           threeparttable = TRUE)  %>% 
  add_header_above(c("Predictors" = 1, "Outcomes" = 12)) %>% 
  kable_styling(latex_options = "scale_down")

           
  # %>% as_flex_table() %>% 
  # add_header_row(values = c("Predictors", "Outcomes"), colwidths = c(1, 12), top = TRUE) %>% 
  # theme_apa() %>%
  # align(j = 1, align = "left", part = "all") %>%
  # line_spacing(space = 1, part = "all") %>% 
  # bold(i = 1, bold = TRUE, part = "header") %>% 
  # italic(i = 3, j = c(3, 5, 7, 9, 11, 13), italic = TRUE, part = "header") %>% 
  # add_footer_lines("*p-value < 0.0035 (Bonferroni corrected)") 


```

```{r}
#| label: tbl-beta2
#| tbl-cap: Multiple Linear Regression Model Results Predicting EF Impairment and ADHD Symptoms in ADHD group


tbl_merge(
  tbls = list(b5_tbl, b6_tbl, ad5_tbl, ad6_tbl),
  tab_spanner = c(glue("**Δ BRIEF2-GEC 5 Week** 
                       F = {b5_F} 
                       R² = {b5_r2}"), 
                  glue("**Δ BRIEF2-GEC 6 Month** 
                       F = {b6_F} 
                       R² = {b6_r2}"), 
                  glue("**Δ SNAP-IV Total 5 Week** 
                       F = {ad5_F}* 
                       R² = {ad5_r2}"), 
                  glue("**Δ SNAP-IV Total 6 Month** 
                       F = {ad6_F}* 
                       R² = {ad6_r2}"))
  ) %>% 
  as_kable_extra(format = "latex", 
                 booktabs = TRUE, 
                 escape = FALSE, 
                 linesep = "", 
                 col.names = c("", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}"),
                 align = c("l", "c", "c", "c", "c", "c", "c", "c", "c")) %>%
  footnote(general = "SSRT - Stop Signal Reaction Time. *p-value < 0.0035 (Bonferroni corrected); Bold p-value < 0.05", 
           footnote_as_chunk = TRUE, 
           escape = FALSE,
           threeparttable = TRUE) %>% 
  add_header_above(c("Predictors" = 1, "Outcomes" = 8)) %>% 
  kable_styling(latex_options = "scale_down")
  
  # as_flex_table() %>% 
  # add_header_row(values = c("Predictors", "Outcomes"), colwidths = c(1, 8), top = TRUE) %>% 
  # theme_apa() %>%
  # align(j = 1, align = "left", part = "all") %>%
  # line_spacing(space = 1, part = "all") %>% 
  # bold(i = 1, bold = TRUE, part = "header") %>% 
  # italic(i = 3, j = c(3, 5, 7, 9), italic = TRUE, part = "header") %>% 
  # add_footer_lines("*p-value < 0.0035 (Bonferroni corrected)") 


```


```{r}
#| label: tbl-beta3
#| tbl-cap: Multiple Linear Regression Model Results Predicting Planning and Fluency in ADHD group


tbl_merge(
  tbls = list(t5_tbl, t6_tbl, w5_tbl, w6_tbl),
  tab_spanner = c(glue("**Δ TAS 5 Week** 
                       F = {t5_F} 
                       R² = {t5_r2}"), 
                  glue("**Δ TAS 6 Month** 
                       F = {t6_F} 
                       R² = {t6_r2}"), 
                  glue("**Δ Fluency 5 Week** 
                       F = {w5_F} 
                       R² = {w5_r2}"), 
                  glue("**Δ Fluency 6 Month** 
                       F = {w6_F} 
                       R² = {w6_r2}"))
  ) %>% 
  as_kable_extra(format = "latex", 
                 booktabs = TRUE, 
                 escape = FALSE, 
                 linesep = "", 
                 col.names = c("", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}"),
                 align = c("l", "c", "c", "c", "c", "c", "c", "c", "c")) %>%
  footnote(general = "SSRT: Stop Signal Reaction Time; TAS: Total Achievement Score (Tower Task). *p-value < 0.0035 (Bonferroni corrected); Bold p-value < 0.05", 
           footnote_as_chunk = TRUE, 
           escape = FALSE,
           threeparttable = TRUE) %>% 
  add_header_above(c("Predictors" = 1, "Outcomes" = 8)) %>% 
  kable_styling(latex_options = "scale_down")
  
  # as_flex_table() %>% 
  # add_header_row(values = c("Predictors", "Outcomes"), colwidths = c(1, 8), top = TRUE) %>% 
  # theme_apa() %>%
  # align(j = 1, align = "left", part = "all") %>%
  # line_spacing(space = 1, part = "all") %>% 
  # bold(i = 1, bold = TRUE, part = "header") %>% 
  # italic(i = 3, j = c(3, 5, 7, 9), italic = TRUE, part = "header") #%>% add_footer_lines("*p-value < 0.0035 (Bonferroni corrected)") 


```
:::

## Autism Group

A multiple linear regression model with all predictors entered (baseline response inhibition, working memory, ADHD symptoms, autism symptoms, and time on task) significantly predicted improvement in response inhibition at post-treatment (F = `{r} s5_F2`, `{r} asd_pvals["s5_p2"]`, R^2^ = `{r} s5_r22`) and at 6 month follow-up (F = `{r} s6_F2`, `{r} asd_pvals["s6_p2"]`, R^2^ = `{r} s6_r22`). Baseline response inhibition was a significant predictor of improvement in response inhibition across both groups at post-treatment (β = `{r} s5_beta_s2`, `{r} asd_pvals["s5_p_s2"]`) and at 6 month follow-up (β = `{r} s5_beta_s2`, `{r} asd_pvals["s6_p_s2"]`). No other individual factors were significant predictors or moderators of response inhibition at 5 weeks or 6 months. See @tbl-beta-asd for results.

Multiple linear regression models with all the predictors did not predict improvement in working memory (1-back) after 5 weeks post-treatment (F = `{r} ob5_F2`, `{r} asd_pvals["ob5_p2"]`, R^2^ = `{r} ob5_r22`) or at 6 months follow-up (F = `{r} ob6_F2`, `{r} asd_pvals["ob6_p2"]`, R^2^ = `{r} ob6_r22`).

Finally, a multiple linear regression model with all predictors entered predicting EF impairment was not significant at post-treatment (F = `{r} b5_F2`, `{r} asd_pvals["b5_p2"]`, R^2^ = `{r} b5_r22`). However, at 6 months follow-up the multiple linear regression model significantly predicted improvement in daily EF impairment (F = `{r} b6_F2`, `{r} asd_pvals["b6_p2"]`, R^2^ = `{r} b6_r22`); however, no individual variables significantly predicted or moderated response.

However, after applying Bonferroni correction to adjust for multiple comparisons (threshold p \< 0.008) only the model predicting response inhibition at 6 month follow-up remained significant.

::: landscape
```{r}
#| label: tbl-beta-asd
#| tbl-cap: Multiple Linear Regression Model Results Predicting Response Inhibition, Working Memory, and EF Impairment in Autistic group

tbl_merge(
  tbls = list(s5_tbl2, s6_tbl2, ob5_tbl2, ob6_tbl2, b5_tbl2, b6_tbl2),
  tab_spanner = c(glue("**Δ SSRT 5 Week** 
                       F = {s5_F2} 
                       R² = {s5_r22}"), 
                  glue("**Δ SSRT 6 Month** 
                       F = {s6_F2} 
                       R² = {s6_r22}"), 
                  glue("**Δ 1-back 5 Week** 
                       F = {ob5_F2} 
                       R² = {ob5_r22}"), 
                  glue("**Δ 1-back 6 Month** 
                       F = {ob6_F2} 
                       R² = {ob6_r22}"), 
                  glue("**Δ BRIEF-2 5 Week** 
                       F = {b5_F2} 
                       R² = {b5_r22}"), 
                  glue("**Δ BRIEF-2 6 Month** 
                       F = {b6_F2} 
                       R² = {b6_r22}"))
  ) %>% 
  as_kable_extra(format = "latex", 
                 booktabs = TRUE, 
                 escape = FALSE, 
                 linesep = "", 
                 col.names = c("", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}"),
                 align = c("l", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c")) %>%
  footnote(general = "SSRT: Stop Signal Reaction Time; TAU - Treatment as Usual; *p-value < 0.008 (Bonferroni corrected); Bold p-value < 0.05", 
           footnote_as_chunk = TRUE, 
           escape = FALSE,
           threeparttable = TRUE)  %>% 
  add_header_above(c("Predictors" = 1, "Outcomes" = 12)) %>% 
  kable_styling(latex_options = "scale_down")


```
:::
