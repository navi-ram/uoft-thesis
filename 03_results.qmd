{{< include preamble.qmd >}}
# Results

## ADHD Group
<!-- if you have extracted your key results into variable names you can call them directly in-text like the following where they will populate with the calculated value -->
A multiple linear regression model for change in response inhibition after 5 weeks of intervention with all the predictors (age, gender, baseline response inhibition, working memory, EF impairment, ADHD symptoms, autism traits, stimulant medication use, and time on task) entered revealed a significant model fit indicating that the baseline characteristics entered predicted response to treatment, accounting for 45% of the variance (F = `{r} s5_F`, `{r} pvals["s5_p"]`, R^2^ = `{r} s5_r2`). Baseline response inhibition ($\beta$ = -0.30, p = 0.02) and baseline working memory ($\beta$ = -0.40, p = 0.0014) predicted improvement in response inhibition after 5 weeks regardless of treatment group such that lower (i.e., worse) baseline response inhibition and higher (i.e., better) baseline working memory (on the N-Back 1-back condition) predicted greater improvement after 5 weeks. Additionally, the model showed a significant interaction effect of baseline response inhibition by randomization group moderating change in response inhibition at 5 weeks post-treatment ($\beta$ = `{r} s5_beta_s`, `{r} pvals["s5_p_s"]`), ruling out the potential for regression to the mean explaining the result.

This result showed that lower (i.e., worse) baseline response inhibition was associated with a larger improvement in the Mega Team treatment group than in the TAU control group in response inhibition after 5 weeks of treatment. No other factors were significant predictors or moderators of change in response inhibition after 5 weeks of treatment (see @tbl-beta1).

<!-- this codeblock is not rendered in the output and is just used to help create the tables -->
```{r, eval=TRUE, results='asis'}
options(knitr.table.format = "latex")
#preps mergable tables
s5_tbl <- tbl_regression(s5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**") 

s6_tbl <- tbl_regression(s6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")


ob5_tbl <- tbl_regression(ob5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")


ob6_tbl <- tbl_regression(ob6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

tb5_tbl <- tbl_regression(tb5_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")

tb6_tbl <- tbl_regression(tb6_mod_all,
                         tidy_fun = tidy_standardize,
                         show_single_row = c(all_categorical(), all_interaction()),
                         conf.int = FALSE,
                          label = list(rand_group = "Treatment Group",
                                       age = "Age",
                                       gender = "Gender",
                                       medstatus = "Stimulants",
                                       bl_snap_comb_sum = "SNAP Total",
                                       bl_scq = "SCQ Score",
                                       bl_itssrt = "SSRT",
                                       bl_target_acc_1 = "Target Accuracy (1-back)",
                                       bl_target_acc_2 = "Target Accuracy (2-back)",
                                       bl_raw_GEC = "BRIEF-2 GEC",
                                       overall_total_timeplayed = "Time on task")) %>%
  #add_glance_table(include = c(nobs, r.squared, statistic, p.value)) %>%
  add_global_p() %>%
  bold_p() %>%
  modify_header(label = "", estimate = "beta", p.value = "**p**")


```

<!-- use a command like below to render some pages in landscape and switch back to portrait afterwards, make sure you enclose the section with ::: at the end as well -->
::: landscape
```{r, eval=TRUE, results='asis'}
#| label: tbl-beta1
#| tbl-cap: Multiple Linear Regression Model Results 
options(knitr.table.format = "latex")

tbl_merge(
  tbls = list(s5_tbl, s6_tbl, ob5_tbl, ob6_tbl, tb5_tbl, tb6_tbl),
  tab_spanner = c(glue("**Δ SSRT 5 Week** 
                       F = {s5_F}* 
                       R² = {s5_r2}"), 
                  glue("**Δ SSRT 6 Month** 
                       F = {s6_F}* 
                       R² = {s6_r2}"), 
                  glue("**Δ 1-back 5 Week** 
                       F = {ob5_F}* 
                       R² = {ob5_r2}"), 
                  glue("**Δ 1-back 6 Month** 
                       F = {ob6_F} 
                       R² = {ob6_r2}"), 
                  glue("**Δ 2-back 5 Week** 
                       F = {tb5_F}* 
                       R² = {tb5_r2}"), 
                  glue("**Δ 2-back 6 Month** 
                       F = {tb6_F}* 
                       R² = {tb6_r2}"))
  ) %>% 
  as_kable_extra(format = "latex", 
                 booktabs = TRUE, 
                 escape = FALSE, 
                 linesep = "", 
                 col.names = c("", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}", "$\\beta$", "\\textit{p}"),
                 align = c("l", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c")) %>%
  footnote(general = "SSRT: Stop Signal Reaction Time. Bold p-value < 0.05.", 
           footnote_as_chunk = TRUE, 
           escape = FALSE,
           threeparttable = TRUE)  %>% 
  add_header_above(c("Predictors" = 1, "Outcomes" = 12)) %>% 
  kable_styling(latex_options = "scale_down")


```

:::

## Autism Group

In the autism group....here is a plot. 


```{r}
#| label: fig-scqssrt
#| fig-cap: SSRT by SCQ in all participants 


plotdat <- MTdat %>% 
   mutate(rand_group = case_when(rand_group == 1 ~ "MegaTeam", 
                                 rand_group == 0 ~ "Treatment as Usual")) %>% 
  filter(visit == 1) 


ggplot(plotdat, aes(x = scq_score, y = itssrt)) + 
  geom_smooth(method = "lm", se = TRUE, fullrange = TRUE) +
  xlab(label = "SCQ Score") + ylab(label = "SSRT (ms)")


```


